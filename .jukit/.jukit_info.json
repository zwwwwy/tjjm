{"cmd": "import pandas as pd\nimport numpy as np\nfrom sklearn.preprocessing import MinMaxScaler\nfrom mtb.tools import prefer_settings\n\nprefer_settings()\n\nscaler = MinMaxScaler()\ndf = pd.read_excel(\"./data/医疗指标.xlsx\")\ndf = df.set_index(\"year\")\ndf = df.loc[2022:2013, :]\n\nfor i in df.columns:\n    df[i] = scaler.fit_transform(df[i].values.reshape(-1, 1))\ndf = df.sort_index(ascending=True)\n\n# |%%--%%| <URpM8k8Gl3|BEPkLl1WLa>\n\ncontrol = [\"卫生总费用(亿元)\", \"政府卫生支出(亿元)\", \"人均卫生费用(元)\"]\ndf_control = df.loc[:, control]\ndf = df.drop(control, axis=1)\n\n# |%%--%%| <BEPkLl1WLa|7BYS9wRI8J>\n\nsum_col = df.sum()\np = pd.DataFrame()\ne_lst = dict()\nk = 1 / np.log(len(df))\nfor i in df.columns:\n    p[i] = df[i] / sum_col[i]\n    tmp = np.log(p[i]) * p[i]\n    e_lst[i] = -k * tmp.sum()\n\n# |%%--%%| <7BYS9wRI8J|QvkdMJZ4sr>\n\ne = pd.Series(e_lst.values(), index=e_lst.keys())\ng = 1 - e\nw1 = g / g.sum()\nw1\n\n# |%%--%%| <QvkdMJZ4sr|ZedYteWGJI>\n\n# CRITIC\ncorr = df.corr()\nstd = df.std()\nr = 1 - corr\nr = r.sum()\nc = std * r\nw2 = c / c.sum()\n#|%%--%%| <ZedYteWGJI|D4vYyBouAq>\n\nw = (w1+w2)/2\nresult = (df*w).sum(axis=1)\nresult.to_csv('./data/综合指数/医疗综合指数.csv')\nw.to_csv(\"./data/综合指数/医疗指标权重.csv\")\nprint(\"完成\")\n\n\n", "cmd_opts": " -s --md_cell_start=r\\\"\\\"\\\"°°°", "import_complete": 1, "terminal": "nvimterm"}